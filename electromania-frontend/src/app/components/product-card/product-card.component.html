<div class="card-producto" [class.is-offer]="isOffer" (click)="onCardClick()" (keyup.enter)="onCardClick()" tabindex="0"
  role="button">
  <div class="badge-container">
    @if (isOffer) {
    <span class="badge badge-offer">{{ 'PRODUCT_CARD.OFFER' | translate }}</span>
    }
    @if (isFeatured) {
    <span class="badge badge-featured">{{ 'PRODUCT_CARD.FEATURED' | translate }}</span>
    }
    @if (product.stock === 0) {
    <span class="badge badge-out-of-stock">{{ 'PRODUCT_CARD.OUT_OF_STOCK' | translate }}</span>
    } @else if (product.stock > 0 && product.stock < 10) {
    <span class="badge badge-low-stock">{{ 'PRODUCT_CARD.LOW_STOCK' | translate }}</span>
    }
  </div>
  <div class="imagen-container">
    @if (product.images && product.images.length > 0) {
      <img [src]="product.images[product.images.length - 1]" [alt]="product.product_name" loading="lazy" (error)="handleImageError($event)">
    } @else {
      <div class="placeholder-image">
        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
          <circle cx="8.5" cy="8.5" r="1.5"></circle>
          <polyline points="21 15 16 10 5 21"></polyline>
        </svg>
        <span>{{ product.product_name }}</span>
      </div>
    }
  </div>
  <div class="info-producto">
    <h4 class="titulo">
      {{ product.product_name }}
    </h4>
    <p class="descripcion">
      {{ product.description }}
    </p>
    <div class="precio-container">
      @if (isOffer) {
      <span class="precio-original">{{ 'CART.BS' | translate }} {{ product.price | number:'1.2-2' }}</span>
      <span class="precio-final">{{ 'CART.BS' | translate }} {{ getDiscountPrice(product.price) | number:'1.2-2' }}</span>
      } @else {
      <span class="precio-final">{{ 'CART.BS' | translate }} {{ product.price | number:'1.2-2' }}</span>
      }
    </div>
    <button class="btn-action" (click)="onAddToCart($event)" [disabled]="product.stock === 0" [class.disabled]="product.stock === 0">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
        stroke-linecap="round" stroke-linejoin="round">
        <circle cx="9" cy="21" r="1"></circle>
        <circle cx="20" cy="21" r="1"></circle>
        <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
      </svg>
      {{ (product.stock === 0 ? 'PRODUCT_CARD.OUT_OF_STOCK' : (isOffer ? 'PRODUCT_CARD.ADD_OFFER' : 'PRODUCT_CARD.ADD')) | translate }}
    </button>
  </div>
</div>
