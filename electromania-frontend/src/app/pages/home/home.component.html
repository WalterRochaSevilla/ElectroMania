<div class="home-container">
  <div class="pagina-catalogo-container">

    <!-- SEARCH & FILTER HEADER (Pinterest Style) -->
    <section class="search-header-wrapper">
      <div class="search-bar-glass">

        <!-- Search Icon & Input -->
        <div class="search-input-group">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round" class="search-icon">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
          </svg>
          <input type="text" [placeholder]="'HOME.SEARCH_PLACEHOLDER' | translate" [(ngModel)]="busqueda" (input)="buscarComponentes()">
          <!-- Clear Button -->
          @if (busqueda) {
            <button class="btn-clear" (click)="busqueda=''; buscarComponentes()">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
              </svg>
            </button>
          }
        </div>

        <div class="divider-vertical"></div>

        <!-- Filter Toggle Button -->
        <button class="btn-filter-toggle" (click)="toggleFiltrosAvanzados()" [class.active]="filtrosAvanzadosAbierto">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round">
            <path d="M22 3H2l8 9.46V19l4 2v-8.54L22 3z"></path>
          </svg>
          {{ 'HOME.FILTERS' | translate }}
          @if (tieneFiltrosActivos) {
            <span class="filter-indicator"></span>
          }
        </button>
      </div>

      <!-- ADVANCED FILTERS PANEL -->
      @if (filtrosAvanzadosAbierto) {
        <div class="advanced-filters-panel">
          <div class="filters-grid">
            <!-- Filter Group: Categories -->
            <div class="filter-group">
              <label for="category-filter">{{ 'HOME.CATEGORY' | translate }}</label>
              <div class="custom-select-wrapper">
                <select id="category-filter" [(ngModel)]="categoriaSeleccionada">
                  <option value="">{{ 'HOME.ALL' | translate }}</option>
                  @for (cat of categorias; track cat) {
                    <option [value]="cat">{{ cat }}</option>
                  }
                </select>
              </div>
            </div>
            <!-- Filter Group: Price -->
            <div class="filter-group">
              <label for="price-filter">{{ 'HOME.PRICE' | translate }}</label>
              <div class="custom-select-wrapper">
                <select id="price-filter" [(ngModel)]="precioSeleccionado">
                  <option value="">{{ 'HOME.ALL_PRICES' | translate }}</option>
                  <option value="0-50">{{ 'HOME.PRICE_UNDER_50' | translate }}</option>
                  <option value="50-100">{{ 'HOME.PRICE_50_100' | translate }}</option>
                  <option value="100+">{{ 'HOME.PRICE_OVER_100' | translate }}</option>
                </select>
              </div>
            </div>
            <!-- Filter Group: Sort -->
            <div class="filter-group">
              <label for="sort-select">{{ 'HOME.SORT_BY' | translate }}</label>
              <div class="custom-select-wrapper">
                <select id="sort-select" [(ngModel)]="orden">
                  <option value="relevancia">{{ 'HOME.RELEVANCE' | translate }}</option>
                  <option value="precioAsc">{{ 'HOME.SORT_PRICE_LOW' | translate }}</option>
                  <option value="precioDesc">{{ 'HOME.SORT_PRICE_HIGH' | translate }}</option>
                </select>
              </div>
            </div>
            <!-- Filter Group: Stock -->
            <div class="filter-group">
              <label for="stock-filter">{{ 'HOME.AVAILABILITY' | translate }}</label>
              <div class="custom-select-wrapper">
                <select id="stock-filter" [(ngModel)]="disponibilidadSeleccionada">
                  <option value="">{{ 'HOME.ALL_PRICES' | translate }}</option>
                  <option value="in-stock">{{ 'HOME.IN_STOCK' | translate }}</option>
                </select>
              </div>
            </div>
          </div>
          <div class="filters-actions">
            <button class="btn-reset" (click)="restablecerFiltros()">{{ 'HOME.RESET' | translate }}</button>
            <button class="btn-apply" (click)="aplicarFiltrosAvanzados()">{{ 'HOME.APPLY_FILTERS' | translate }}</button>
          </div>
        </div>
      }


    </section>

    <!-- MAIN CONTENT (Full Width Grid) -->
    <div class="main-catalogo full-width">
      <section class="contenido-catalogo">

        <div class="grid-productos">
          @for (producto of productosFiltrados; track producto.product_id) {
            <app-product-card [product]="producto"
              (cardClick)="router.navigate(['/detalle-producto', producto.product_id])" (addToCart)="agregarAlCarrito($event)">
            </app-product-card>
          }
        </div>

      </section>
    </div>
  </div>
</div>